\documentclass{article}
\usepackage[UTF8]{ctex}
\usepackage{float,indentfirst,verbatim,fancyhdr,graphicx,listings,longtable,amsmath, amsfonts,amssymb}
\usepackage{algorithm}
\usepackage{amsmath}
\usepackage{algpseudocode}
\usepackage{float}
\usepackage{longtable}
\textheight 23.5cm \textwidth 15.8cm
%\leftskip -1cm
\topmargin -1.5cm \oddsidemargin 0.3cm \evensidemargin -0.3cm
\usepackage[framemethod=TikZ]{mdframed}
\usepackage{url}   % 网页链接
\usepackage{subcaption} % 子标题
\usepackage[left=2.50cm, right=2.50cm, top=2.50cm, bottom=2.50cm]{geometry} %页边距
\usepackage{helvet}
\usepackage{amsmath, amsfonts, amssymb} % 数学公式、符号
%\usepackage[english]{babel}
\usepackage{graphicx}   % 图片
\usepackage{url}        % 超链接
\usepackage{bm}         % 加粗方程字体
\usepackage{multirow}
\usepackage{booktabs}
%\usepackage{algorithm}
%\usepackage{algorithmic}
\usepackage{esint}
\usepackage{hyperref} %bookmarks
\usepackage{fancyhdr} %设置页眉、页脚
%\hypersetup{colorlinks, bookmarks, unicode} %unicode
\usepackage{multicol}
\usepackage{graphicx}
\usepackage{xcolor}
\title{数值代数实验报告}
\author{PB21010483 郭忠炜}

\begin{document}
\maketitle

\section*{\centerline{一、问题描述}}

\subsection*{Exercise1}

已知一个84阶线性方程组$Ax=b$, 其中矩阵A为84x84的系数矩阵，向量b为长度为84的常数向量。需要用C++代码编写通用的子程序，实现不选主元的Gauss消去法、全主元Gauss消去法以及列主元Gauss消去法，并利用这些算法求解该84阶线性方程组，输出计算结果，计算结果和准确解的误差以及运行时间。

\subsection*{Exercise2}

给定一个对称正定的线性方程组$Ax=b$，需要用C++代码编写通用的子程序，实现平方根法(Cholesky分解)和改进平方根法，并利用这些算法求解对称正定方程组，输出运行时间。

\subsection*{Exercise3}

利用第题中编写的通用子程序分别求解第2题中给定的两个方程组，分别使用不选主元的Gauss消去法、全主元Gauss消去法、列主元Gaussy消去法以及平方根法和改进平方根法进行求解，并比较并对比各方法的计算结果。


\section*{\centerline{二、程序介绍}}

\subsection*{Exercise1}

%\subsubsection*{前代法\&回代法}

\subsubsection*{前代法 (Forward Substitution):}
\begin{itemize}
	\item \textbf{算法描述:} 前代法用于解决下三角矩阵方程 \(Lx=b\)，其中L为下三角矩阵，对角线上的元素为1。
	\item \textbf{使用方式:} 调用 \texttt{forward\_subs(L, b)} 函数，传入下三角矩阵L和常数向量b，函数会修改b以得到解向量x。
\end{itemize}

\subsubsection*{对角元为1的前代法:}
\begin{itemize}
	\item \textbf{算法描述:} 对角元为1的前代法是前代法的一种特例，适用于对角元为1的下三角矩阵方程 \(Lx=b\)。
	\item \textbf{使用方式:} 调用 \texttt{forward\_subs1(L, b)} 函数，传入下三角矩阵L和常数向量b，函数会修改b以得到解向量x。
\end{itemize}

\subsubsection*{回代法 (Backward Substitution):}
\begin{itemize}
	\item \textbf{算法描述:} 回代法用于解决上三角矩阵方程 \(Ux=y\)，其中U为上三角矩阵。
	\item \textbf{使用方式:} 调用 \texttt{back\_subs(U, y)} 函数，传入上三角矩阵U和常数向量y，函数会修改y以得到解向量x。
\end{itemize}

\subsubsection*{对角元为1的回代法:}
\begin{itemize}
	\item \textbf{算法描述:} 对角元为1的回代法是回代法的一种特例，适用于对角元为1的上三角矩阵方程 \(Ux=y\)。
	\item \textbf{使用方式:} 调用 \texttt{back\_subs1(U, y)} 函数，传入上三角矩阵U和常数向量y，函数会修改y以得到解向量x。
\end{itemize}

\subsubsection*{Gauss消去法:}
\begin{itemize}
	\item \textbf{函数名:} \texttt{void gauss\_elim(vector<vector<double>>\& A);}
	\item \textbf{算法描述:} Gauss消去法用于求解线性方程组，通过消元过程将系数矩阵变换为上三角矩阵。
\end{itemize}

\subsubsection*{全主元Gauss消去法:}
\begin{itemize}
	\item \textbf{函数名:} \texttt{void gauss\_elim\_full\_pivoting(vector<vector<double>>\& A, vector<int>\& u, vector<int>\& v);}
	\item \textbf{算法描述:} 全主元Gauss消去法是一种高级的Gauss消去法，选择主元时考虑行列均进行选择，提高数值稳定性。
\end{itemize}

\subsubsection*{列主元Gauss消去法:}
\begin{itemize}
	\item \textbf{函数名:} \texttt{void gauss\_elim\_col\_pivoting(vector<vector<double>>\& A, vector<int>\& u);}
	\item \textbf{算法描述:} 列主元Gauss消去法是Gauss消去法的一种改进算法，选择主元时仅在列中选择，提高数值稳定性。
\end{itemize}

\subsubsection*{打印矩阵:}
\begin{itemize}
	\item \textbf{函数名:} \texttt{void print(vector<vector<double>>\& mat);}
	\item \textbf{功能描述:} 该函数用于打印矩阵到输出，方便观察矩阵的内容。
\end{itemize}

\subsection*{Exercise2}

\subsubsection*{对称正定阵标准Cholesky分解:}
\begin{itemize}
	\item \textbf{函数名:} \texttt{void cholesky\_decomp(vector<vector<double>>\& A);}
	\item \textbf{功能描述:} 该函数用于对称正定阵 \(A\) 进行标准的Cholesky分解，得到 \(A = LL^T\)，其中 \(L\) 是下三角矩阵。
\end{itemize}

\subsubsection*{改进的平方根法:}
\begin{itemize}
	\item \textbf{函数名:} \texttt{void modified\_cholesky\_decomp(vector<vector<double>>\& A);}
	\item \textbf{功能描述:} 该函数用于对称正定阵 \(A\) 进行改进的平方根法，得到 \(A = LDL^T\) 分解，其中 \(D\) 是对角矩阵，\(L\) 是下三角矩阵。
\end{itemize}


\section*{\centerline{三、实验结果}}

\subsection*{Exercise1}

\begin{table}[htbp]
	\centering
	\begin{tabular}{lcccccc}
		\toprule
		\textbf{} & \textbf{不选主元} & \textbf{误差} & \textbf{全主元} & \textbf{误差} & \textbf{列主元} & \textbf{误差} \\
		\midrule
		1         & 1           & 0             & 1           & 0             & 1           & 0             \\
		2         & 1           & 2.22E-16      & 1           & 2.22E-16      & 1           & 0             \\
		3         & 1           & 4.44E-16      & 1           & 4.44E-16      & 1           & 0             \\
		4         & 1           & 8.88E-16      & 1           & 8.88E-16      & 1           & 0             \\
		5         & 1           & 1.78E-15      & 1           & 1.78E-15      & 1           & 0             \\
		6         & 1           & 3.55E-15      & 1           & 3.55E-15      & 1           & 0             \\
		7         & 1           & 7.11E-15      & 1           & 7.11E-15      & 1           & 0             \\
		8         & 1           & 1.42E-14      & 1           & 1.42E-14      & 1           & 0             \\
		9         & 1           & 2.84E-14      & 1           & 2.84E-14      & 1           & 0             \\
		10        & 1           & 5.68E-14      & 1           & 5.68E-14      & 1           & 0             \\
		11        & 1           & 1.14E-13      & 1           & 1.14E-13      & 1           & 0             \\
		12        & 1           & 2.27E-13      & 1           & 2.27E-13      & 1           & 0             \\
		13        & 1           & 4.55E-13      & 1           & 4.55E-13      & 1           & 0             \\
		14        & 1           & 9.09E-13      & 1           & 9.09E-13      & 1           & 0             \\
		15        & 1           & 1.82E-12      & 1           & 1.82E-12      & 1           & 0             \\
		16        & 1           & 3.64E-12      & 1           & 3.64E-12      & 1           & 0             \\
		17        & 1           & 7.28E-12      & 1           & 7.28E-12      & 1           & 0             \\
		18        & 1           & 1.46E-11      & 1           & 1.46E-11      & 1           & 0             \\
		19        & 1           & 2.91E-11      & 1           & 2.91E-11      & 1           & 0             \\
		20        & 1           & 5.82E-11      & 1           & 5.82E-11      & 1           & 0             \\
       \bottomrule
		
	\end{tabular}
\end{table}


\begin{table}[htbp]
	\centering
	\begin{tabular}{lcccccc}
		\toprule
		\textbf{} & \textbf{不选主元} & \textbf{误差} & \textbf{全主元} & \textbf{误差} & \textbf{列主元} & \textbf{误差} \\
		\midrule
	
		21        & 1           & 1.16E-10      & 1           & 1.16E-10      & 1           & 0             \\
		22        & 1           & 2.33E-10      & 1           & 2.33E-10      & 1           & 0             \\
		23        & 1           & 4.66E-10      & 1           & 4.66E-10      & 1           & 0             \\
		24        & 1           & 9.31E-10      & 1           & 9.31E-10      & 1           & 0             \\
		25        & 1           & 1.86E-09      & 1           & 1.86E-09      & 1           & 0             \\
		26        & 1           & 3.73E-09      & 1           & 3.73E-09      & 1           & 0             \\
		27        & 1           & 7.45E-09      & 1           & 7.45E-09      & 0           & 1             \\
		28        & 1           & 1.49E-08      & 1           & 1.49E-08      & 16          & 15            \\
		29        & 1           & 2.98E-08      & 1           & 2.98E-08      & -128        & 129           \\
		30        & 1           & 5.96E-08      & 1           & 5.96E-08      & 1024        & 1023          \\
		31        & 1           & 1.19E-07      & 1           & 1.19E-07      & -5120       & 5121          \\
		32        & 1           & 2.38E-07      & 1           & 2.38E-07      & 24576       & 24575         \\
		33        & 1           & 4.77E-07      & 1           & 4.77E-07      & -98304      & 98305         \\
		34        & 1           & 9.54E-07      & 1           & 9.54E-07      & 327680      & 327679        \\
		35        & 0.999998    & 1.91E-06      & 0.999998    & 1.91E-06      & -1.31E+06   & 1.31E+06      \\
		36        & 1           & 3.81E-06      & 1           & 3.81E-06      & 6.29E+06    & 6.29E+06      \\
		37        & 0.999992    & 7.63E-06      & 0.999992    & 7.63E-06      & -2.52E+07   & 2.52E+07      \\
		38        & 1.00002     & 1.53E-05      & 1.00002     & 1.53E-05      & 8.39E+07    & 8.39E+07      \\
		39        & 0.999969    & 3.05E-05      & 0.999969    & 3.05E-05      & -3.36E+08   & 3.36E+08      \\
		40        & 1.00006     & 6.10E-05      & 1.00006     & 6.10E-05      & 1.61E+09    & 1.61E+09      \\
		41        & 0.999878    & 0.000122063   & 0.999878    & 0.000122063   & -6.44E+09   & 6.44E+09      \\
		42        & 1.00024     & 0.000244126   & 1.00024     & 0.000244126   & 2.15E+10    & 2.15E+10      \\
		43        & 0.999512    & 0.000488251   & 0.999512    & 0.000488251   & -8.59E+10   & 8.59E+10      \\
		44        & 1.00098     & 0.000976503   & 1.00098     & 0.000976503   & 4.12E+11    & 4.12E+11      \\
		45        & 0.998047    & 0.00195301    & 0.998047    & 0.00195301    & -1.65E+12   & 1.65E+12      \\
		46        & 1.00391     & 0.00390601    & 1.00391     & 0.00390601    & 5.50E+12    & 5.50E+12      \\
		47        & 0.992188    & 0.00781202    & 0.992188    & 0.00781202    & -2.20E+13   & 2.20E+13      \\
		48        & 1.01562     & 0.015624      & 1.01562     & 0.015624      & 1.06E+14    & 1.06E+14      \\
		49        & 0.968752    & 0.0312481     & 0.968752    & 0.0312481     & -4.22E+14   & 4.22E+14      \\
		50        & 1.0625      & 0.0624962     & 1.0625      & 0.0624962     & 1.41E+15    & 1.41E+15      \\
		51        & 0.875008    & 0.124992      & 0.875008    & 0.124992      & -5.63E+15   & 5.63E+15      \\
		52        & 1.24998     & 0.249985      & 1.24998     & 0.249985      & 1.80E+16    & 1.80E+16      \\
		53        & 0.500031    & 0.499969      & 0.500031    & 0.499969      & -1.80E+16   & 1.80E+16      \\
		54        & 1.99994     & 0.999939      & 1.99994     & 0.999939      & 0           & 1             \\
		55        & -0.999878   & 1.99988       & -0.999878   & 1.99988       & 0           & 1             \\
		56        & 4.99976     & 3.99976       & 4.99976     & 3.99976       & 0           & 1             \\
		
		\bottomrule
	\end{tabular}
\end{table}

\begin{table}[H]
	\centering
	\begin{tabular}{lcccccc}
		\toprule
		\textbf{} & \textbf{不选主元} & \textbf{误差} & \textbf{全主元} & \textbf{误差} & \textbf{列主元} & \textbf{误差} \\
		\midrule
		57        & -6.99951    & 7.99951       & -6.99951    & 7.99951       & 0           & 1             \\
		58        & 16.999      & 15.999        & 16.999      & 15.999        & 0           & 1             \\
		59        & -30.998     & 31.998        & -30.998     & 31.998        & 0           & 1             \\
		60        & 64.9961     & 63.9961       & 64.9961     & 63.9961       & 0           & 1             \\
		61        & -126.992    & 127.992       & -126.992    & 127.992       & 0           & 1             \\
		62        & 256.984     & 255.984       & 256.984     & 255.984       & 0           & 1             \\
		63        & -510.969    & 511.969       & -510.969    & 511.969       & 0           & 1             \\
		64        & 1024.94     & 1023.94       & 1024.94     & 1023.94       & 0           & 1             \\
		65        & -2046.87    & 2047.87       & -2046.87    & 2047.87       & 0           & 1             \\
		66        & 4096.74     & 4095.74       & 4096.74     & 4095.74       & 0           & 1             \\
		67        & -8190.47    & 8191.47       & -8190.47    & 8191.47       & 0           & 1             \\
		68        & 16383.9     & 16382.9       & 16383.9     & 16382.9       & 0           & 1             \\
		69        & -32764.5    & 32765.5       & -32764.5    & 32765.5       & 0           & 1             \\
		70        & 65531       & 65530         & 65531       & 65530         & 0           & 1             \\
		71        & -131055     & 131056        & -131055     & 131056        & 0           & 1             \\
		72        & 262097      & 262096        & 262097      & 262096        & 0           & 1             \\       
		73        & -524127     & 524128        & -524127     & 524128        & 0           & 1             \\
		74        & 1.05E+06    & 1.05E+06      & 1.05E+06    & 1.05E+06      & 0           & 1             \\
		75        & -2.09E+06   & 2.09E+06      & -2.09E+06   & 2.09E+06      & 0           & 1             \\
		76        & 4.19E+06    & 4.19E+06      & 4.19E+06    & 4.19E+06      & 0           & 1             \\
		77        & -8.36E+06   & 8.36E+06      & -8.36E+06   & 8.36E+06      & 0           & 1             \\
		78        & 1.66E+07    & 1.66E+07      & 1.66E+07    & 1.66E+07      & 0           & 1             \\
		79        & -3.30E+07   & 3.30E+07      & -3.30E+07   & 3.30E+07      & 0           & 1             \\
		80        & 6.50E+07    & 6.50E+07      & 6.50E+07    & 6.50E+07      & 0           & 1             \\
		81        & -1.26E+08   & 1.26E+08      & -1.26E+08   & 1.26E+08      & 0           & 1             \\
		82        & 2.35E+08    & 2.35E+08      & 2.35E+08    & 2.35E+08      & 0           & 1             \\
		83        & -4.03E+08   & 4.03E+08      & -4.03E+08   & 4.03E+08      & 0           & 1             \\
		84        & 5.37E+08    & 5.37E+08      & 5.37E+08    & 5.37E+08      & 1           & 0            \\
		\bottomrule
	\end{tabular}
	\caption{计算结果和准确解的误差表}
\end{table}

\begin{table}[H]
	\centering
	\begin{tabular}{llll}
		\toprule
		& 不选主元          & 全主元         & 列主元          \\
		\midrule
		用时 & 0.108 seconds & 0.11seconds & 0.09 seconds		\\
		\bottomrule
	\end{tabular}
	\caption{运行时间表}
\end{table}


\subsection*{Exercise2(1)}
\begin{table}[H]
	\centering
	\begin{tabular}{cccccccccccc}
		\toprule
		\multicolumn{6}{c}{\textbf{平方根法解}}                                           & \multicolumn{6}{c}{\textbf{改进平方根法解}}                                         \\
		\midrule
		1        & 0.2479        & 34            & 0.0669            & 67  & -0.0388 & 1        & 0.2479        & 34            & 0.0669            & 67  & -0.0388 \\
		2        & 0.0129        & 35            & 0.1807            & 68  & 0.1832  & 2        & 0.0129        & 35            & 0.1807            & 68  & 0.1832  \\
		3        & 0.2611        & 36            & 0.0447            & 69  & 0.1762  & 3        & 0.2611        & 36            & 0.0447            & 69  & 0.1762  \\
		4        & 0.0467        & 37            & 0.2346            & 70  & 0.2234  & 4        & 0.0467        & 37            & 0.2346            & 70  & 0.2234  \\
		5        & 0.0144        & 38            & 0.0859            & 71  & -0.0439 & 5        & 0.0144        & 38            & 0.0859            & 71  & -0.0439 \\
		6        & 0.2968        & 39            & 0.0999            & 72  & 0.1259  & 6        & 0.2968        & 39            & 0.0999            & 72  & 0.1259  \\
		7        & -0.0464       & 40            & 0.1820            & 73  & 0.1408  & 7        & -0.0464       & 40            & 0.1820            & 73  & 0.1408  \\
		8        & 0.0578        & 41            & 0.1606            & 74  & 0.0579  & 8        & 0.0578        & 41            & 0.1606            & 74  & 0.0579  \\
		9        & 0.1398        & 42            & 0.0607            & 75  & 0.0653  & 9        & 0.1398        & 42            & 0.0607            & 75  & 0.0653  \\
		10       & 0.2064        & 43            & 0.0574            & 76  & 0.2498  & 10       & 0.2064        & 43            & 0.0574            & 76  & 0.2498  \\
		11       & 0.0371        & 44            & 0.1982            & 77  & -0.0349 & 11       & 0.0371        & 44            & 0.1982            & 77  & -0.0349 \\
		12       & 0.0475        & 45            & 0.1264            & 78  & 0.1673  & 12       & 0.0475        & 45            & 0.1264            & 78  & 0.1673  \\
		13       & -0.0241       & 46            & 0.0651            & 79  & 0.2223  & 13       & -0.0241       & 46            & 0.0651            & 79  & 0.2223  \\
		14       & 0.1329        & 47            & 0.2775            & 80  & 0.1490  & 14       & 0.1329        & 47            & 0.2775            & 80  & 0.1490  \\
		15       & 0.2253        & 48            & -0.0661           & 81  & 0.1488  & 15       & 0.2253        & 48            & -0.0661           & 81  & 0.1488  \\
		16       & 0.1090        & 49            & 0.0354            & 82  & 0.0365  & 16       & 0.1090        & 49            & 0.0354            & 82  & 0.0365  \\
		17       & 0.2013        & 50            & 0.0607            & 83  & 0.0248  & 17       & 0.2013        & 50            & 0.0607            & 83  & 0.0248  \\
		18       & 0.0581        & 51            & 0.0346            & 84  & 0.2709  & 18       & 0.0581        & 51            & 0.0346            & 84  & 0.2709  \\
		19       & 0.0763        & 52            & 0.2380            & 85  & 0.2031  & 19       & 0.0763        & 52            & 0.2380            & 85  & 0.2031  \\
		20       & 0.1674        & 53            & 0.1734            & 86  & -0.0613 & 20       & 0.1674        & 53            & 0.1734            & 86  & -0.0613 \\
		21       & -0.0359       & 54            & 0.0392            & 87  & 0.0039  & 21       & -0.0359       & 54            & 0.0392            & 87  & 0.0039  \\
		22       & 0.2076        & 55            & 0.2865            & 88  & 0.1919  & 22       & 0.2076        & 55            & 0.2865            & 88  & 0.1919  \\
		23       & 0.0630        & 56            & -0.0705           & 89  & 0.0391  & 23       & 0.0630        & 56            & -0.0705           & 89  & 0.0391  \\
		24       & 0.1499        & 57            & 0.2738            & 90  & 0.2649  & 24       & 0.1499        & 57            & 0.2738            & 90  & 0.2649  \\
		25       & 0.2378        & 58            & 0.1482            & 91  & 0.1919  & 25       & 0.2378        & 58            & 0.1482            & 91  & 0.1919  \\
		26       & 0.1044        & 59            & 0.1801            & 92  & 0.2077  & 26       & 0.1044        & 59            & 0.1801            & 92  & 0.2077  \\
		27       & -0.0325       & 60            & 0.2074            & 93  & 0.0815  & 27       & -0.0325       & 60            & 0.2074            & 93  & 0.0815  \\
		28       & 0.1311        & 61            & -0.0752           & 94  & 0.0381  & 28       & 0.1311        & 61            & -0.0752           & 94  & 0.0381  \\
		29       & 0.0306        & 62            & 0.1387            & 95  & 0.0985  & 29       & 0.0306        & 62            & 0.1387            & 95  & 0.0985  \\
		30       & 0.2120        & 63            & -0.0132           & 96  & 0.0099  & 30       & 0.2120        & 63            & -0.0132           & 96  & 0.0099  \\
		31       & 0.1209        & 64            & 0.2832            & 97  & 0.0491  & 31       & 0.1209        & 64            & 0.2832            & 97  & 0.0491  \\
		32       & 0.0549        & 65            & -0.0679           & 98  & 0.1073  & 32       & 0.0549        & 65            & -0.0679           & 98  & 0.1073  \\
		33		 & 0.0396  		 &   66			 & 0.3096        & 99  & 0.1225  & 33       & 0.0396        & 66            & 0.3096            & 99  & 0.1225  \\
		\multicolumn{2}{c}{运行时间} & \multicolumn{2}{l}{0.076 seconds} & 100 & 0.5931  & \multicolumn{2}{c}{运行时间} & \multicolumn{2}{c}{0.068 seconds} & 100 & 0.5931 \\
		\bottomrule
	\end{tabular}
	\caption{计算结果和运行时间表}
\end{table}

\subsection*{Exercise2(2)}
在调试时，将Hilbert矩阵规模设置为$10*10$，可得到结果如下表：
\begin{table}[H]
	\centering
	\begin{tabular}{ccc}
		\toprule
		& \textbf{平方根法解} & \textbf{改进平方根法解} \\
		\midrule
		1& 1.96057        & 1.96057          \\
		2& 50.8609        & 50.8606          \\
		3& -1223.86       & -1223.86         \\
		4& 12465.8        & 12465.7          \\
		5& -65930         & -65929.8         \\
		6& 199298         & 199297           \\
		7& -357087        & -357086          \\
		8& 374671         & 374670           \\
		9& -212518        & -212517          \\
		10& 50284.1        & 50284            \\
		运行时间 & 0.002 seconds & 0.002 seconds  \\
		\bottomrule
	\end{tabular}
	\caption{计算结果和运行时间对比（Hilbert矩阵规模为10*10时）}
\end{table}

但当将Hilbert矩阵规模设置为$13*13$时，情况发生了变化：
\begin{table}[H]
	\centering
	\begin{tabular}{ccc}
		\toprule
		& \textbf{平方根法解}        & \textbf{改进平方根法解} \\
		\midrule
	1	& 2.66303               & 2.01689          \\
	2	& -17.8955              & 89.9864          \\
	3	& 1200.63               & -3167.5          \\
	4	& -27813.9              & 47883.6          \\
	5	& 316988                & -385837          \\
	6	& -2.07E+06             & 1.85E+06         \\
	7	& 8.44E+06              & -5.58E+06        \\
	8	& -2.23E+07             & 1.09E+07         \\
	9	& 3.90E+07              & -1.37E+07        \\
	10	& -4.47E+07             & 1.07E+07         \\
	11	& 3.22E+07              & -4.75E+06        \\
	12	& -1.33E+07             & 909097           \\
	13	& 2.39E+06              & 6.28868          \\
		运行时间 & 0.003 seconds         & 0.003 seconds    \\
		备注   & 矩阵非正定，无法进行Cholesky分解 &             \\
		\bottomrule    
	\end{tabular}
	\caption{计算结果和运行时间对比（Hilbert矩阵规模为13*13时）}
\end{table}
\newpage
当Hilbert的规模增大到$40*40$时，平方根法输出全为$-nan(ind)$, 改进平方根法输出如下：
\begin{table}[H]
	\centering
	\begin{tabular}{llllllll}
		\toprule
		\multicolumn{8}{c}{\textbf{改进平方根法}}                             \\
		\midrule
		1  & 1.77601   & 11 & -1.17E+07 & 21 & 0.699359 & 31 & 0.507126 \\
		2  & 228.585   & 12 & 2.23E+06  & 22 & 0.675185 & 32 & 0.492376 \\
		3  & -8030.31  & 13 & 0.974661  & 23 & 0.652425 & 33 & 0.478204 \\
		4  & 121009    & 14 & 0.928553  & 24 & 0.63093  & 34 & 0.464576 \\
		5  & -971857   & 15 & 0.886911  & 25 & 0.610572 & 35 & 0.451457 \\
		6  & 4.64E+06  & 16 & 0.849017  & 26 & 0.591241 & 36 & 0.438819 \\
		7  & -1.40E+07 & 17 & 0.814305  & 27 & 0.572844 & 37 & 0.426634 \\
		8  & 2.72E+07  & 18 & 0.782321  & 28 & 0.5553   & 38 & 0.414879 \\
		9  & -3.40E+07 & 19 & 0.752696  & 29 & 0.538538 & 39 & 0.40353  \\
		10 & 2.65E+07  & 20 & 0.725126  & 30 & 0.522498 & 40 & 10.6061 \\
		\multicolumn{4}{c}{运行时间} & \multicolumn{4}{c}{0.02 seconds} \\
		\bottomrule
	\end{tabular}
	\caption{改进平方根法运行时间（Hilbert矩阵规模为40*40时）}
\end{table}

\subsection*{Exercise3(1)}

\begin{longtable}[c]{cccccccccccc}
	\toprule
	\multicolumn{4}{c}{\textbf{不选主元}}                            & \multicolumn{4}{c}{\textbf{全主元}}                                      & \multicolumn{4}{c}{\textbf{列主元}}                                      \\
	\endfirsthead
	%
	\endhead
	%
	\midrule
	1         & 0.0794       & 51            & 0.0537            & 1        & 0.0794        & 51            & 0.0286            & 1        & 0.0794        & 51            & 0.0537            \\
	2         & 0.0717       & 52            & 0.0066            & 2        & 0.0650        & 52            & 0.0508            & 2        & 0.0717        & 52            & 0.0066            \\
	3         & 0.0650       & 53            & 0.0508            & 3        & 0.0717        & 53            & 0.0066            & 3        & 0.0650        & 53            & 0.0508            \\
	4         & 0.0379       & 54            & 0.0750            & 4        & 0.0311        & 54            & 0.0530            & 4        & 0.0379        & 54            & 0.0750            \\
	5         & 0.0311       & 55            & 0.0530            & 5        & 0.0379        & 55            & 0.0750            & 5        & 0.0311        & 55            & 0.0530            \\
	6         & 0.0326       & 56            & 0.0127            & 6        & 0.0176        & 56            & 0.0144            & 6        & 0.0326        & 56            & 0.0127            \\
	7         & 0.0176       & 57            & 0.0144            & 7        & 0.0326        & 57            & 0.0127            & 7        & 0.0176        & 57            & 0.0144            \\
	8         & 0.0484       & 58            & 0.0464            & 8        & 0.0652        & 58            & 0.0163            & 8        & 0.0484        & 58            & 0.0464            \\
	9         & 0.0652       & 59            & 0.0163            & 9        & 0.0484        & 59            & 0.0464            & 9        & 0.0652        & 59            & 0.0163            \\
	10        & 0.0844       & 60            & 0.0635            & 10       & 0.0292        & 60            & 0.0837            & 10       & 0.0844        & 60            & 0.0635            \\
	11        & 0.0292       & 61            & 0.0837            & 11       & 0.0844        & 61            & 0.0635            & 11       & 0.0292        & 61            & 0.0837            \\
	12        & 0.0051       & 62            & 0.0244            & 12       & -0.0060       & 62            & 0.0254            & 12       & 0.0051        & 62            & 0.0244            \\
	13        & -0.0060      & 63            & 0.0254            & 13       & 0.0051        & 63            & 0.0244            & 13       & -0.0060       & 63            & 0.0254            \\
	14        & 0.0680       & 64            & 0.0572            & 14       & 0.0905        & 64            & 0.0674            & 14       & 0.0680        & 64            & 0.0572            \\
	15        & 0.0905       & 65            & 0.0674            & 15       & 0.0680        & 65            & 0.0572            & 15       & 0.0905        & 65            & 0.0674            \\
	16        & 0.0244       & 66            & 0.0498            & 16       & 0.0448        & 66            & 0.0411            & 16       & 0.0244        & 66            & 0.0498            \\
	17        & 0.0448       & 67            & 0.0411            & 17       & 0.0244        & 67            & 0.0498            & 17       & 0.0448        & 67            & 0.0411            \\
	18        & 0.0467       & 68            & 0.0850            & 18       & 0.0682        & 68            & 0.0690            & 18       & 0.0467        & 68            & 0.0850            \\
	\bottomrule
	\newpage
	\toprule
	19        & 0.0682       & 69            & 0.0690            & 19       & 0.0467        & 69            & 0.0850            & 19       & 0.0682        & 69            & 0.0690            \\
	20        & 0.0065       & 70            & 0.0263            & 20       & 0.0639        & 70            & 0.0128            & 20       & 0.0065        & 70            & 0.0263            \\
	21        & 0.0639       & 71            & 0.0128            & 21       & 0.0065        & 71            & 0.0263            & 21       & 0.0639        & 71            & 0.0128            \\
	22        & 0.0056       & 72            & 0.0662            & 22       & 0.0865        & 72            & 0.0335            & 22       & 0.0056        & 72            & 0.0662            \\
	23        & 0.0865       & 73            & 0.0335            & 23       & 0.0056        & 73            & 0.0662            & 23       & 0.0865        & 73            & 0.0335            \\
	24        & 0.0106       & 74            & 0.0362            & 24       & -0.0009       & 74            & 0.0287            & 24       & 0.0106        & 74            & 0.0362            \\
	25        & -0.0009      & 75            & 0.0287            & 25       & 0.0106        & 75            & 0.0362            & 25       & -0.0009       & 75            & 0.0287            \\
	26        & 0.0935       & 76            & 0.0640            & 26       & -0.0030       & 76            & 0.0461            & 26       & 0.0935        & 76            & 0.0640            \\
	27        & -0.0030      & 77            & 0.0461            & 27       & 0.0935        & 77            & 0.0640            & 27       & -0.0030       & 77            & 0.0461            \\
	28        & 0.0674       & 78            & 0.0409            & 28       & 0.0606        & 78            & 0.0091            & 28       & 0.0674        & 78            & 0.0409            \\
	29        & 0.0606       & 79            & 0.0091            & 29       & 0.0674        & 79            & 0.0409            & 29       & 0.0606        & 79            & 0.0091            \\
	30        & 0.0226       & 80            & 0.0982            & 30       & 0.0707        & 80            & -0.0168           & 30       & 0.0226        & 80            & 0.0982            \\
	31        & 0.0707       & 81            & -0.0168           & 31       & 0.0226        & 81            & 0.0982            & 31       & 0.0707        & 81            & -0.0168           \\
	32        & 0.0176       & 82            & 0.0771            & 32       & 0.0099        & 82            & 0.0749            & 32       & 0.0176        & 82            & 0.0771            \\
	33        & 0.0099       & 83            & 0.0749            & 33       & 0.0176        & 83            & 0.0771            & 33       & 0.0099        & 83            & 0.0749            \\
	34        & 0.0450       & 84            & 0.0103            & 34       & 0.0690        & 84            & 0.0571            & 34       & 0.0450        & 84            & 0.0103            \\
	35        & 0.0690       & 85            & 0.0571            & 35       & 0.0450        & 85            & 0.0103            & 35       & 0.0690        & 85            & 0.0571            \\
	36        & 0.0055       & 86            & 0.0238            & 36       & 0.0787        & 86            & 0.0643            & 36       & 0.0055        & 86            & 0.0238            \\
	37        & 0.0787       & 87            & 0.0643            & 37       & 0.0055        & 87            & 0.0238            & 37       & 0.0787        & 87            & 0.0643            \\
	38        & 0.0691       & 88            & 0.0572            & 38       & -0.0061       & 88            & 0.0454            & 38       & 0.0691        & 88            & 0.0572            \\
	39        & -0.0061      & 89            & 0.0454            & 39       & 0.0691        & 89            & 0.0572            & 39       & -0.0061       & 89            & 0.0454            \\
	40        & 0.0877       & 90            & 0.0779            & 40       & 0.0601        & 90            & 0.0445            & 40       & 0.0877        & 90            & 0.0779            \\
	41        & 0.0601       & 91            & 0.0445            & 41       & 0.0877        & 91            & 0.0779            & 41       & 0.0601        & 91            & 0.0445            \\
	42        & 0.0029       & 92            & -0.0005           & 42       & 0.0740        & 92            & 0.0024            & 42       & 0.0029        & 92            & -0.0005           \\
	43        & 0.0740       & 93            & 0.0024            & 43       & 0.0029        & 93            & -0.0005           & 43       & 0.0740        & 93            & 0.0024            \\
	44        & -0.0042      & 94            & 0.0818            & 44       & 0.0410        & 94            & 0.0150            & 44       & -0.0042       & 94            & 0.0818            \\
	45        & 0.0410       & 95            & 0.0150            & 45       & -0.0042       & 95            & 0.0818            & 45       & 0.0410        & 95            & 0.0150            \\
	46        & 0.0170       & 96            & 0.0598            & 46       & -0.0069       & 96            & 0.0823            & 46       & 0.0170        & 96            & 0.0598            \\
	47        & -0.0069      & 97            & 0.0823            & 47       & 0.0170        & 97            & 0.0598            & 47       & -0.0069       & 97            & 0.0823            \\
	48        & 0.0998       & 98            & 0.0273            & 48       & -0.0111       & 98            & 0.0557            & 48       & 0.0998        & 98            & 0.0273            \\
	49        & -0.0111      & 99            & 0.0557            & 49       & 0.0998        & 99            & 0.0273            & 49       & -0.0111       & 99            & 0.0557            \\
	50        & 0.0286       & 100           & 0.1099            & 50       & 0.0537        & 100           & 0.1099            & 50       & 0.0286        & 100           & 0.1099            \\
	\multicolumn{2}{c}{运行时间} & \multicolumn{2}{c}{0.076 seconds} & \multicolumn{2}{c}{运行时间} & \multicolumn{2}{c}{0.103 seconds} & \multicolumn{2}{c}{运行时间} & \multicolumn{2}{c}{0.095 seconds}	\\
	\bottomrule
	\caption{计算结果和用时对比}
	\label{tab:my-table}\\
\end{longtable}

\subsection*{Exercise3(2)}

\begin{table}[H]
	\centering
	\begin{tabular}{ccccccc}
		\toprule
		& \multicolumn{2}{c}{\textbf{不选主元}} & \multicolumn{2}{c}{\textbf{全主元}}  & \multicolumn{2}{c}{\textbf{列主元}}  \\
		\midrule
		& 1            & 1                  & 1             & 1                 & 1             & 1                 \\
		& 2            & 1                  & 2             & 0.999997          & 2             & 0.999998          \\
		& 3            & 0.999994           & 3             & 1.00006           & 3             & 1.00019           \\
		& 4            & 1.00006            & 4             & 1                 & 4             & 1.00003           \\
		& 5            & 0.999723           & 5             & 1.00031           & 5             & 1.00001           \\
		& 6            & 1.00076            & 6             & 1.00002           & 6             & 0.999931          \\
		& 7            & 0.998763           & 7             & 1.00048           & 7             & 1                 \\
		& 8            & 1.00119            & 8             & 0.999887          & 8             & 0.99969           \\
		& 9            & 0.999377           & 9             & 0.999749          & 9             & 1.0003            \\
		& 10           & 1.00014            & 10            & 0.999499          & 10            & 0.999844          \\
		运行时间 & \multicolumn{2}{c}{0.003 seconds} & \multicolumn{2}{c}{0.001 seconds} & \multicolumn{2}{c}{0.003 seconds}\\
		\midrule
		&&&&&&\\
		\toprule
		& \multicolumn{2}{c}{不选主元}          & \multicolumn{2}{c}{全主元}           & \multicolumn{2}{c}{列主元}           \\
		\midrule
		& 1            & 0.999999           & 1            & 1                  & 1            & 1                  \\
		& 2            & 1.00017            & 2            & 0.998426           & 2            & 1.00056            \\
		& 3            & 0.99352            & 3            & -47.8937           & 3            & 0.203514           \\
		& 4            & 1.1081             & 4            & 1.00004            & 4            & -1.46658           \\
		& 5            & 0.0504351          & 5            & -6.43881           & 5            & 5.38361            \\
		& 6            & 5.81279            & 6            & 0.777825           & 6            & 1.1154             \\
		& 7            & -13.3839           & 7            & -2.61425           & 7            & 0.999987           \\
		& 8            & 24.7593            & 8            & -61.3392           & 8            & 4.8446             \\
		& 9            & -14.2507           & 9            & 1.0257             & 9            & -12.6205           \\
		& 10           & -5.00823           & 10           & -13.0946           & 10           & 36.8833            \\
		& 11           & -13.8618           & 11           & -85.9081           & 11           & -67.9851           \\
		& 12           & 98.2343            & 12           & 2.13049            & 12           & 93.1463            \\
		& 13           & -145.2             & 13           & -53.1714           & 13           & -76.8821           \\
		& 14           & 90.4002            & 14           & 8.86779            & 14           & 34.8013            \\
		& 15           & 4.77186            & 15           & 40.7346            & 15           & -2.41486           \\
		& 16           & -62.1442           & 16           & 100.224            & 16           & 0.989265           \\
		& 17           & 96.3345            & 17           & 22.2882            & 17           & 19.6988            \\
		& 18           & -89.5854           & 18           & 66.5434            & 18           & -45.3425           \\
		& 19           & 47.7277            & 19           & 17.2066            & 19           & 48.7222            \\
		& 20           & -8.75859           & 20           & 27.6634            & 20           & -22.0773           \\
		运行时间 & \multicolumn{2}{c}{0.006 seconds} & \multicolumn{2}{c}{0.006 seconds} & \multicolumn{2}{c}{0.011 seconds}\\
		\bottomrule
	\end{tabular}
	\caption{Hilbert矩阵规模分别为10*10和20*20时，三种Gauss消去法对比}
	\label{tab:my-table}
\end{table}

\begin{longtable}[c]{ccccccc}
	\toprule
	& \multicolumn{2}{c}{不选主元}          & \multicolumn{2}{c}{全主元}           & \multicolumn{2}{c}{列主元}           \\
	\endfirsthead
	%
	\endhead
	%
	\midrule
	& 1  & 1                            & 1  & 0.999999                     & 1  & 1                            \\
	& 2  & 1.00007                      & 2  & 0.994283                     & 2  & 0.998159                     \\
	& 3  & 0.997396                     & 3  & 221.128                      & 3  & 1.34066                      \\
	& 4  & 1.04062                      & 4  & 1.00019                      & 4  & -197.13                      \\
	& 5  & 0.688188                     & 5  & 51.7217                      & 5  & 375.545                      \\
	& 6  & 2.16725                      & 6  & 1.14704                      & 6  & 60.1569                      \\
	& 7  & -0.09895                     & 7  & 353.146                      & 7  & 1.00005                      \\
	& 8  & -6.48777                     & 8  & 42.3566                      & 8  & 2.4463                       \\
	& 9  & 32.0032                      & 9  & 1.05077                      & 9  & -8.20327                     \\
	& 10 & -47.142                      & 10 & -683.862                     & 10 & 16.95                        \\
	& 11 & 23.3459                      & 11 & 430.28                       & 11 & 4.98925                      \\
	& 12 & 22.2094                      & 12 & 349.822                      & 12 & -40.2305                     \\
	& 13 & -18.2317                     & 13 & 930.253                      & 13 & 36.736                       \\
	& 14 & 1.72533                      & 14 & -4.49972                     & 14 & -35.4382                     \\
	& 15 & -14.1245                     & 15 & -269.77                      & 15 & 147.314                      \\
	& 16 & 4.57317                      & 16 & -158.185                     & 16 & 1.02657                      \\
	& 17 & 53.4637                      & 17 & -60.1119                     & 17 & 67.7104                      \\
	& 18 & -72.8923                     & 18 & 602.663                      & 18 & 10.5476                      \\
	& 19 & 53.59                        & 19 & -417.383                     & 19 & 3.96324                      \\
	& 20 & -53.7596                     & 20 & -138.321                     & 20 & -47.5535                     \\
	\multicolumn{1}{l}{} & 21 & 74.8231                      & 21 & -558.489                     & 21 & 158.6                        \\
	\multicolumn{1}{l}{} & 22 & \multicolumn{1}{l}{-17.048}  & 22 & \multicolumn{1}{l}{399.168}  & 22 & \multicolumn{1}{l}{-11.9498} \\
	\multicolumn{1}{l}{} & 23 & \multicolumn{1}{l}{-68.6389} & 23 & \multicolumn{1}{l}{-395.482} & 23 & \multicolumn{1}{l}{-122.167} \\
	\multicolumn{1}{l}{} & 24 & \multicolumn{1}{l}{56.6681}  & 24 & \multicolumn{1}{l}{342.492}  & 24 & \multicolumn{1}{l}{-113.586} \\
	\multicolumn{1}{l}{} & 25 & \multicolumn{1}{l}{-11.1791} & 25 & \multicolumn{1}{l}{290.033}  & 25 & \multicolumn{1}{l}{26.8195}  \\
	\multicolumn{1}{l}{} & 26 & \multicolumn{1}{l}{19.5501}  & 26 & \multicolumn{1}{l}{63.2139}  & 26 & \multicolumn{1}{l}{201.084}  \\
	\multicolumn{1}{l}{} & 27 & \multicolumn{1}{l}{32.2028}  & 27 & \multicolumn{1}{l}{-573.267} & 27 & \multicolumn{1}{l}{97.0492}  \\
	\multicolumn{1}{l}{} & 28 & \multicolumn{1}{l}{-98.1378} & 28 & \multicolumn{1}{l}{450.221}  & 28 & \multicolumn{1}{l}{-252.567} \\
	\multicolumn{1}{l}{} & 29 & \multicolumn{1}{l}{5.36355}  & 29 & \multicolumn{1}{l}{-119.802} & 29 & \multicolumn{1}{l}{80.3402}  \\
	\multicolumn{1}{l}{} & 30 & \multicolumn{1}{l}{63.8895}  & 30 & \multicolumn{1}{l}{-285.384} & 30 & \multicolumn{1}{l}{-122.646} \\
	\multicolumn{1}{l}{} & 31 & \multicolumn{1}{l}{97.906}   & 31 & \multicolumn{1}{l}{186.689}  & 31 & \multicolumn{1}{l}{0.83012}  \\
	\multicolumn{1}{l}{} & 32 & \multicolumn{1}{l}{-114.617} & 32 & \multicolumn{1}{l}{-19.9021} & 32 & \multicolumn{1}{l}{-391.711} \\
	\multicolumn{1}{l}{} & 33 & \multicolumn{1}{l}{-21.487}  & 33 & \multicolumn{1}{l}{-231.583} & 33 & \multicolumn{1}{l}{38.7715}  \\
	\multicolumn{1}{l}{} & 34 & \multicolumn{1}{l}{-6.23057} & 34 & \multicolumn{1}{l}{-612.265} & 34 & \multicolumn{1}{l}{95.8394}  \\
	\multicolumn{1}{l}{} & 35 & \multicolumn{1}{l}{-7.30572} & 35 & \multicolumn{1}{l}{-52.2416} & 35 & \multicolumn{1}{l}{150.707}  \\
	\multicolumn{1}{l}{} & 36 & \multicolumn{1}{l}{81.1841}  & 36 & \multicolumn{1}{l}{-200.499} & 36 & \multicolumn{1}{l}{-122.862} \\
	\multicolumn{1}{l}{} & 37 & \multicolumn{1}{l}{-22.3064} & 37 & \multicolumn{1}{l}{560.419}  & 37 & \multicolumn{1}{l}{-173.557} \\
	\bottomrule
	\newpage
	\toprule
	\multicolumn{1}{l}{} & 38 & \multicolumn{1}{l}{19.2249}  & 38 & \multicolumn{1}{l}{-170.929} & 38 & \multicolumn{1}{l}{-180.102} \\
	\multicolumn{1}{l}{} & 39 & \multicolumn{1}{l}{-56.1343} & 39 & \multicolumn{1}{l}{385.507}  & 39 & \multicolumn{1}{l}{93.6363}  \\
	\multicolumn{1}{l}{} & 40 & \multicolumn{1}{l}{27.2058}  & 40 & \multicolumn{1}{l}{-672.326} & 40 & \multicolumn{1}{l}{184.301}  \\
	运行时间                 & \multicolumn{2}{c}{0.011 seconds} & \multicolumn{2}{c}{0.025 seconds} & \multicolumn{2}{c}{0.021 seconds}\\
	\bottomrule
	\caption{Hilbert矩阵规模为40*40时，三种Gauss消去法对比}\\
	\label{tab:my-table}\\
\end{longtable}


\section*{\centerline{四、结果分析}}

\subsection*{Exercise1}

从运算结果来看，在$x1 \sim x 26$的求解中，不选主元的Gauss消去法、全主元的Gauss消去法和列主元的Gauss消去法表现出了很好的一致性。而随着矩阵规模的增大，列主元的Gauss消去法开始变得不稳定，而不选主元的Gauss消去法和全主元的Gauss消去法全程表现出了一致性。\\
从运行时间来看，三者几乎没有差别。

\subsection*{Exercise2(1)}

在对系数矩阵为对称正定矩阵的线性方程组的求解时，平方根法和改进的平方根法得到了相同的结果，而改进的平方根法有一定的性能优势。

\subsection*{Exercise2(2)}

在Hilbert矩阵规模较小（10*10）时，平方根法和改进的平方根法可以表现出相同的性能；当Hilbert 矩阵规模设置为 13 ∗ 13 时，由于Hilbert矩阵本身的性质，使得开方操作出错，致使平方根法无法进行Cholesky分解；对于题给的Hilbert矩阵（40*40）规模，平方根法输出全为$−nan(ind)$, 改进平方根法正常给出了输出。

\subsection*{Exercise3(1)}

从运算结果来看，不选主元的Gauss消去法和列主元的Gauss消去法全程表现出了很好的一致性。而通过观察会发现全主元的Gauss消去法在求解时时不时会与另外两种方法求解出现相同大小分量的错位，但三者输出的解的范数相差不大。\\
从运行时间来看，全主元的Gauss消去法的运行速度明显有优势，而不选主元的Gauss消去法又优于列主元的Gauss消去法。

\subsection*{Exercise3(2)}

随着Hilbert矩阵规模的增大，不选主元的Gauss消去法、全主元的Gauss消去法和列主元的Gauss消去法在规模较小时能保持输出结果的大体相同（全主元的Gauss消去法运行时间最短），在较大规模时会出现三种方法的输出各不相同的现象。


\end{document}